DROP TABLE IF EXISTS `options`;
DROP TABLE IF EXISTS `midjourneys`;
DROP TABLE IF EXISTS `logs`;
DROP TABLE IF EXISTS `abilities`;
DROP TABLE IF EXISTS `tokens`;
DROP TABLE IF EXISTS `tasks`;
DROP TABLE IF EXISTS `setups`;
DROP TABLE IF EXISTS `quota_data`;
DROP TABLE IF EXISTS `channels`;
DROP TABLE IF EXISTS `redemptions`;
DROP TABLE IF EXISTS `top_ups`;
DROP TABLE IF EXISTS `users`;

CREATE TABLE `options` (`key` VARCHAR(255),`value` LONGTEXT,PRIMARY KEY (`key`));
INSERT INTO options VALUES('gpt-4.1_ratio','1.0');
INSERT INTO options VALUES('gpt-4.1_price','0.01');
CREATE TABLE `midjourneys` (`id` BIGINT,`code` BIGINT,`user_id` BIGINT,`action` varchar(40),`mj_id` LONGTEXT,`prompt` LONGTEXT,`prompt_en` LONGTEXT,`description` LONGTEXT,`state` LONGTEXT,`submit_time` BIGINT,`start_time` BIGINT,`finish_time` BIGINT,`image_url` LONGTEXT,`video_url` LONGTEXT,`video_urls` LONGTEXT,`status` varchar(20),`progress` varchar(30),`fail_reason` LONGTEXT,`channel_id` BIGINT,`quota` BIGINT,`buttons` LONGTEXT,`properties` json,PRIMARY KEY (`id`));
CREATE TABLE `logs` (`id` BIGINT,`user_id` BIGINT,`created_at` BIGINT,`type` BIGINT,`content` LONGTEXT,`username` VARCHAR(255),`token_name` VARCHAR(255),`model_name` VARCHAR(255),`quota` BIGINT DEFAULT 0,`prompt_tokens` BIGINT DEFAULT 0,`completion_tokens` BIGINT DEFAULT 0,`use_time` BIGINT DEFAULT 0,`is_stream` TINYINT(1),`channel_id` BIGINT,`channel_name` VARCHAR(255),`token_id` BIGINT DEFAULT 0,`group` VARCHAR(255),`ip` VARCHAR(255),`other` LONGTEXT,PRIMARY KEY (`id`));
CREATE TABLE `abilities` (`group` varchar(64),`model` varchar(255),`channel_id` BIGINT,`enabled` TINYINT(1),`priority` BIGINT DEFAULT 0,`weight` BIGINT DEFAULT 0,`tag` VARCHAR(255),PRIMARY KEY (`group`,`model`,`channel_id`));
INSERT INTO abilities VALUES('default','gpt-4.1',1,1,0,0,NULL);
CREATE TABLE `tokens` (`id` BIGINT,`user_id` BIGINT,`key` char(48),`status` BIGINT DEFAULT 1,`name` VARCHAR(255),`created_time` BIGINT,`accessed_time` BIGINT,`expired_time` BIGINT DEFAULT -1,`remain_quota` BIGINT DEFAULT 0,`unlimited_quota` TINYINT(1),`model_limits_enabled` TINYINT(1),`model_limits` varchar(1024),`allow_ips` VARCHAR(1000),`used_quota` BIGINT DEFAULT 0,`group` VARCHAR(255),`deleted_at` DATETIME,PRIMARY KEY (`id`));
CREATE TABLE `tasks` (`id` BIGINT,`created_at` BIGINT,`updated_at` BIGINT,`task_id` varchar(50),`platform` varchar(30),`user_id` BIGINT,`channel_id` BIGINT,`quota` BIGINT,`action` varchar(40),`status` varchar(20),`fail_reason` LONGTEXT,`submit_time` BIGINT,`start_time` BIGINT,`finish_time` BIGINT,`progress` varchar(20),`properties` json,`data` json,PRIMARY KEY (`id`));
CREATE TABLE `setups` (`id` BIGINT,`version` varchar(50) NOT NULL,`initialized_at` BIGINT NOT NULL,PRIMARY KEY (`id`));
INSERT INTO setups VALUES(1,'v1.0.0',1755754580);
CREATE TABLE `quota_data` (`id` BIGINT,`user_id` BIGINT,`username` VARCHAR(255),`model_name` VARCHAR(255),`created_at` BIGINT,`token_used` BIGINT DEFAULT 0,`count` BIGINT DEFAULT 0,`quota` BIGINT DEFAULT 0,PRIMARY KEY (`id`));
CREATE TABLE `channels` (`id` BIGINT,`type` BIGINT DEFAULT 0,`key` LONGTEXT NOT NULL,`open_ai_organization` LONGTEXT,`test_model` LONGTEXT,`status` BIGINT DEFAULT 1,`name` VARCHAR(255),`weight` BIGINT DEFAULT 0,`created_time` BIGINT,`test_time` BIGINT,`response_time` BIGINT,`base_url` LONGTEXT,`other` LONGTEXT,`balance` DOUBLE,`balance_updated_time` BIGINT,`models` LONGTEXT,`group` varchar(64) DEFAULT "default",`used_quota` BIGINT DEFAULT 0,`model_mapping` LONGTEXT,`status_code_mapping` varchar(1024),`priority` BIGINT DEFAULT 0,`auto_ban` BIGINT DEFAULT 1,`other_info` LONGTEXT,`tag` VARCHAR(255),`setting` LONGTEXT,`param_override` LONGTEXT,`channel_info` json,PRIMARY KEY (`id`));
INSERT INTO channels VALUES(1,0,'secret','','gpt-4.1',1,'PollinationsAI',0,1755756103,NULL,NULL,'http://68.183.101.45:8080','{"endpoint_type": "openai", "support_models": true}',NULL,NULL,'gpt-4.1','default',0,'null','{"400": "500"}',0,1,NULL,NULL,'{"force_format": true}','{"temperature": 0}','{"is_multi_key":false,"multi_key_size":0,"multi_key_status_list":null,"multi_key_polling_index":0,"multi_key_mode":"random"}');
CREATE TABLE `redemptions` (`id` BIGINT,`user_id` BIGINT,`key` char(32),`status` BIGINT DEFAULT 1,`name` VARCHAR(255),`quota` BIGINT DEFAULT 100,`created_time` BIGINT,`redeemed_time` BIGINT,`used_user_id` BIGINT,`deleted_at` DATETIME,`expired_time` BIGINT,PRIMARY KEY (`id`));
CREATE TABLE IF NOT EXISTS `top_ups` (`id` BIGINT,`user_id` BIGINT,`amount` BIGINT,`money` DOUBLE,`trade_no` varchar(255) UNIQUE,`create_time` BIGINT,`complete_time` BIGINT,`status` VARCHAR(255),PRIMARY KEY (`id`));
CREATE TABLE IF NOT EXISTS `users` (`id` BIGINT,`username` VARCHAR(255) UNIQUE,`password` LONGTEXT NOT NULL,`display_name` VARCHAR(255),`role` BIGINT DEFAULT 1,`status` BIGINT DEFAULT 1,`email` VARCHAR(255),`github_id` VARCHAR(255),`oidc_id` VARCHAR(255),`wechat_id` VARCHAR(255),`telegram_id` VARCHAR(255),`access_token` char(32),`quota` BIGINT DEFAULT 0,`used_quota` BIGINT DEFAULT 0,`request_count` BIGINT DEFAULT 0,`group` varchar(64) DEFAULT "default",`aff_code` varchar(32),`aff_count` BIGINT DEFAULT 0,`aff_quota` BIGINT DEFAULT 0,`aff_history` BIGINT DEFAULT 0,`inviter_id` BIGINT,`deleted_at` DATETIME,`linux_do_id` VARCHAR(255),`setting` LONGTEXT,`remark` varchar(255),`stripe_customer` varchar(64),PRIMARY KEY (`id`));
INSERT INTO users VALUES(1,'jeel','.KK8H7vLXfXH6ASvusETqEHgK/zIpghzK.QQD9K/iyePGJc6','Root User',100,1,'swastik6622@gmail.com',NULL,NULL,NULL,NULL,NULL,100000000,0,0,'default',NULL,0,0,0,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO users VALUES(2,'swastik','$2a$10$cvPCvOdNVeNm6Wu9zi6pduNLRf42/drjg/ytN3jAC0wt/E69h3Ngm','Root Admin',100,1,'','','','','',NULL,100000000,0,0,'default','L5I2',0,0,0,0,NULL,'','','','');
CREATE INDEX `idx_midjourneys_start_time` ON `midjourneys`(`start_time`);
CREATE INDEX `idx_created_at_type` ON `logs`(`created_at`,`type`);
CREATE INDEX `idx_created_at_id` ON `logs`(`id`,`created_at`);
CREATE INDEX `idx_logs_model_name` ON `logs`(`model_name`);
CREATE INDEX `idx_logs_token_name` ON `logs`(`token_name`);
CREATE INDEX `index_username_model_name` ON `logs`(`model_name`,`username`);
CREATE INDEX `idx_logs_username` ON `logs`(`username`);
CREATE INDEX `idx_logs_user_id` ON `logs`(`user_id`);
CREATE INDEX `idx_logs_ip` ON `logs`(`ip`);
CREATE INDEX `idx_logs_group` ON `logs`(`group`);
CREATE INDEX `idx_logs_token_id` ON `logs`(`token_id`);
CREATE INDEX `idx_logs_channel_id` ON `logs`(`channel_id`);
CREATE INDEX `idx_abilities_tag` ON `abilities`(`tag`);
CREATE INDEX `idx_abilities_weight` ON `abilities`(`weight`);
CREATE INDEX `idx_abilities_priority` ON `abilities`(`priority`);
CREATE INDEX `idx_abilities_channel_id` ON `abilities`(`channel_id`);
CREATE INDEX `idx_midjourneys_submit_time` ON `midjourneys`(`submit_time`);
CREATE INDEX `idx_midjourneys_mj_id` ON `midjourneys`(`mj_id`);
CREATE INDEX `idx_midjourneys_action` ON `midjourneys`(`action`);
CREATE INDEX `idx_midjourneys_user_id` ON `midjourneys`(`user_id`);
CREATE INDEX `idx_midjourneys_progress` ON `midjourneys`(`progress`);
CREATE INDEX `idx_midjourneys_status` ON `midjourneys`(`status`);
CREATE INDEX `idx_midjourneys_finish_time` ON `midjourneys`(`finish_time`);
CREATE INDEX `idx_tasks_action` ON `tasks`(`action`);
CREATE INDEX `idx_tasks_channel_id` ON `tasks`(`channel_id`);
CREATE INDEX `idx_tasks_created_at` ON `tasks`(`created_at`);
CREATE INDEX `idx_tasks_progress` ON `tasks`(`progress`);
CREATE INDEX `idx_tasks_finish_time` ON `tasks`(`finish_time`);
CREATE INDEX `idx_tasks_user_id` ON `tasks`(`user_id`);
CREATE INDEX `idx_tasks_platform` ON `tasks`(`platform`);
CREATE INDEX `idx_tasks_task_id` ON `tasks`(`task_id`);
CREATE INDEX `idx_tasks_start_time` ON `tasks`(`start_time`);
CREATE INDEX `idx_tasks_submit_time` ON `tasks`(`submit_time`);
CREATE INDEX `idx_tasks_status` ON `tasks`(`status`);
CREATE INDEX `idx_qdt_model_user_name` ON `quota_data`(`model_name`,`username`);
CREATE INDEX `idx_quota_data_user_id` ON `quota_data`(`user_id`);
CREATE INDEX `idx_qdt_created_at` ON `quota_data`(`created_at`);
CREATE INDEX `idx_channels_name` ON `channels`(`name`);
CREATE INDEX `idx_channels_tag` ON `channels`(`tag`);
CREATE INDEX `idx_tokens_user_id` ON `tokens`(`user_id`);
CREATE UNIQUE INDEX `idx_redemptions_key` ON `redemptions`(`key`);
CREATE INDEX `idx_redemptions_deleted_at` ON `redemptions`(`deleted_at`);
CREATE INDEX `idx_redemptions_name` ON `redemptions`(`name`);
CREATE INDEX `idx_tokens_deleted_at` ON `tokens`(`deleted_at`);
CREATE INDEX `idx_tokens_name` ON `tokens`(`name`);
CREATE UNIQUE INDEX `idx_tokens_key` ON `tokens`(`key`);
CREATE INDEX `idx_top_ups_user_id` ON `top_ups`(`user_id`);
CREATE INDEX `idx_top_ups_trade_no` ON `top_ups`(`trade_no`);
CREATE INDEX `idx_users_oidc_id` ON `users`(`oidc_id`);
CREATE INDEX `idx_users_we_chat_id` ON `users`(`wechat_id`);
CREATE INDEX `idx_users_telegram_id` ON `users`(`telegram_id`);
CREATE UNIQUE INDEX `idx_users_access_token` ON `users`(`access_token`);
CREATE UNIQUE INDEX `idx_users_aff_code` ON `users`(`aff_code`);
CREATE INDEX `idx_users_inviter_id` ON `users`(`inviter_id`);
CREATE INDEX `idx_users_deleted_at` ON `users`(`deleted_at`);
CREATE INDEX `idx_users_linux_do_id` ON `users`(`linux_do_id`);
CREATE INDEX `idx_users_stripe_customer` ON `users`(`stripe_customer`);
CREATE INDEX `idx_users_username` ON `users`(`username`);
CREATE INDEX `idx_users_display_name` ON `users`(`display_name`);
CREATE INDEX `idx_users_email` ON `users`(`email`);
CREATE INDEX `idx_users_git_hub_id` ON `users`(`github_id`);